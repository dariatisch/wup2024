{
  "hash": "a2f6040ef503357bf828d8c7c770ffdc",
  "result": {
    "engine": "knitr",
    "markdown": "---\nformat:\n  live-revealjs:\n    theme: default\n    slideNumber: true\n    chalkboard:\n      theme: whiteboard\n      boardmarker-width: 5\n      buttons: true\ntitle: \"2. Seminar: Paneldaten\"\nsubtitle: \"Fortgeschrittene quantitative Methoden <br> Wintersemester 2024-2025\"\nauthor: \"Daria Tisch\"\n# webr:\n#   cell-options:\n#     autorun: true\n#     fig-width: 11\n#     fig-height: 5\n  # webr:\n  # packages:\n  #   - dplyr\n  #   - ggplot2\neditor: visual\n---\n\n\n\n\n<!-- {{< include ../_extensions/r-wasm/live/_knitr.qmd >}} -->\n# Erhebung und Auswertung von Paneldaten\n\n## Heutige Sitzung {.smaller}\n\n1.  Erhebungsdesigns: Querschnitt-, Trend- und **Paneldaten**\n2.  Fehlerquellen: Datenerhebung vs. Datenauswertung\n3.  Kausalanalyse mit Paneldaten\n4.  Regressionsmodelle mit Paneldaten\n\nPflichtlektüre:\n\n-   Elwert, F. and Winship, C. (2014). ‘Endogenous Selection Bias: The Problem of Conditioning on a Collider Variable’. Annual Review of Sociology 40: 31–53.\n\n-   Brüderl, J. (2010). Kausalanalyse mit Paneldaten. In Handbuch der sozialwissenschaftlichen Datenanalyse (pp. 963-994). VS Verlag für Sozialwissenschaften.\n\n# Erhebungsdesigns\n\n## Erhebungsdesigns vergleichen\n\n-   **Querschnittdesign**: Daten zu einem Zeitpunkt von verschiedenen Personen\n\n-   **Trenddesign**: Daten zu mehreren Zeitpunkten, aber unterschiedliche Personen\n\n-   **Paneldesign**: Daten zu mehreren Zeitpunkten von denselben Personen\n\n## Querschnitt-, Trend- und Paneldaten\n\nWelche Fragestellungen bieten sich bei welchem Studiendesign an?\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](2_seminar_files/figure-revealjs/unnamed-chunk-1-1.png){width=960}\n:::\n:::\n\n\n\n\n## Paneldaten\n\n-   Paneldaten: wiederholte Messung derselben Variablen an denselben Untersuchungseinheiten (Brüderl 2010)\n-   Wenn N = 1: Zeitreihendaten\n-   Vorteile gegenüber Querschnittsdaten\n    -   intraindividuelle Veränderungen\n    -   zeitliche Abfolge von Veränderungen\n    -   Problem der unbeobachteter Heterogenität abmildern\n\n## Wichtige Panelstudien {.smaller}\n\n-   Panel Study of Income Dynamics (PSID)\n\n-   SOEP\n\n-   Understanding Society (UKHLS)\n\n-   Familienpanel (pairfam)\n\n-   FreDa\n\n-   Nationales Bildungspanel (NEPS)\n\n-   Survey of Health, Ageing and Retirement in Europe (SHARE)\n\n-   Arbeitsmarkt und soziale Sicherung (PASS)\n\n-   TwinLife\n\n-   Children of Immigrants (CILS4EU)\n\n-   GESIS Panel (auch offline)\n\n-   SoSci Panel\n\n-   Übersicht: [Forschungsdaten in Deutschland](https://www.konsortswd.de/angebote/forschende/alle-datenzentren/)\n\n# Fehlerquellen: Datenerhebung &. Datenauswertung\n\n# Fehlerquellen {.smaller}\n\n![](images/clipboard-2497836276.png)\n\nM. Groves, Lars Lyberg, Total Survey Error: Past, Present, and Future, Public Opinion Quarterly, Volume 74, Issue 5, 2010, Pages 849–879, https://doi.org/10.1093/poq/nfq065\n\n## Potentielle Panelprobleme {.smaller}\n\n***Konstanz der Messinstrumente***: Semantische Gehalt von Begriffen kann sich über die Jahre ändern (Frageformulierungen)\n\n***Ausfallrate / Panelmortalität***: Befragte nehmen nicht mehr an der Umfrage teil\n\n-   Ursachen: Fehlende Motivation, Umzug, Tod/Krankheit\n\n-   Problem: systematischer Ausfall\n\n-   Lösungsansatz: Höherer Stichprobenumfang, intensive Panelpflege; Anreize (Incentivierung)\n\n***Paneleffekte (reaktive Messungen)***:\n\n-   Interviewereffekte (Interviewer und Befragte lernen sich über die Wellen kennen)\n-   Verhalten des Interviewers weicht von Erstbefragung ab (kennt den Ablauf)\n-   Belastungs- und Gewöhnungseffekte\n\n## Gütekriterien für Messinstrumente:\n\n-   Validität (Gültigkeit): Messen wir eigentlich das richtige?\n\n-   Reliabilität (Zuverlässigkeit): Wiederholte Messungen müssen zum gleichen Ergebnis führen\n\n    -   Voraussetzung für Validität (aber nicht umgekehrt)\n\n-   Objektivität: Unabhängigkeit der Ergebnisse von der jeweiligen Person, die das Messinstrument anwendet\n\n## Validität\n\n**Externe Validität**\n\n-   Auf Grundgesamtheit übertragbar?\n\n-   Validität des Messinstruments wird vorausgesetzt\n\n**Interne Validität**\n\n-   Eindeutigkeit der Ergebnisinterpretation\n\n-   „Je besser ein Design dazu geeignet ist, die aufgestellten Hypothesen zu prüfen und Alternativerklärungen auszuschließen, umso höher ist die interne Validität“\n\n-   Kausalanalytischer Anspruch von Experimenten (können Störfaktoren eliminieren)\n\n# Kausalanalyse mit Paneldaten\n\n## Kontrafaktischer Kausalitätsbegriff\n\n<center>X ➯ Y</center>\n\n$$\n\\Delta_i = Y(X=1, t_0) - Y(X=0, t_0)\n$$ Vergleich eines faktischen und eines kontrafaktischen Outcomes.\n\n## Between-Schätzer\n\n<center>X ➯ Y</center>\n\nBetween-Schätzer:\n\n$$\n\\Delta_i^B = Y_i(X=1, t_0) - Y_j(X=0, t_0)\n$$\n\nZentrale Annahme: $Person_i$ und $Person_j$ unterscheiden sich nur in X\n\n⇨ keine unbeobachtete Heterogenität (unbeobachtete personen- oder zeitspezifische Einflussfaktoren)\n\n## Within-Schätzer\n\n<center>X ➯ Y</center>\n\nWithin-Schätzer:\n\n$$\n\\Delta_i^W = Y_i(X=1, t_1) - Y_i(X=0, t_0)\n$$ Zentrale Annahme: $Person_i$ unterscheidet sich über die Zeit nur in X (keine **zeitveränderliche** unbeobachtete Heterogenität)\n\n# Regressionsmodelle mit Paneldaten\n\n## Regressionsmodelle: POLS\n\nPOLS (pooled OLS): Wir behandeln die Daten, als wären es eine Reihe von Querschnittsdaten (Personen- und Zeitdimension wird ignoriert)\n\nAnnahme: unabhängige Beobachtungen\n\n$$\ny_{it} = \\alpha + \\beta_{POLS} x_{it} + \\upsilon_{it},\n$$\n\ni: individual\n\nt: time point\n\n## POLS\n\n$$\ny_{it} = \\alpha + \\beta_{POLS} x_{it} + \\upsilon_{it},\n$$\n\n::: panel-tabset\n## Output\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">lz</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.40</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.83&nbsp;&ndash;&nbsp;6.96</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">alter</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.01&nbsp;&ndash;&nbsp;0.07</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.007</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">34</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.207 / 0.182</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n\n## Code\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_pols <- lm(lz ~ alter, data = df)\ntab_model(m_pols)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">lz</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.40</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.83&nbsp;&ndash;&nbsp;6.96</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">alter</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.01&nbsp;&ndash;&nbsp;0.07</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.007</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">34</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.207 / 0.182</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n:::\n\n## POLS, graphisch\n\n::: panel-tabset\n## Output\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](2_seminar_files/figure-revealjs/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n\n\n## Code\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# The palette with black:\ncbp2 <- c(\"#000000\", \n          \"#E69F00\", \n          \"#56B4E9\", \n          \"#009E73\",\n          \"#F0E442\", \n          \"#0072B2\", \n          \"#D55E00\", \n          \"#CC79A7\")\n\n# Save the residual values\ndf$predicted <- predict(m_pols)\ndf$residuals <- residuals(m_pols)\n\np_pols <- ggplot(df, aes(alter, lz)) +\n  geom_point( aes(x = alter, y = lz, shape = id_name, colour = id_name, fill = id_name), \n              size = 2, stroke = 1) +\n  geom_smooth(method = 'lm', formula = y ~ x, se = FALSE,\n              color  = \"cyan\") +\n  geom_segment(aes(xend = alter, yend = predicted), \n               alpha = .3, color = \"deeppink\") +\n  annotate(\"text\", x = 30, y = 9.9, \n           label = paste0(\"beta[POLS] ==\", round(m_pols$coefficients[2], 3)), \n           parse = TRUE) +\n  scale_colour_manual(values = cbp2[-c(1)]) +\n  scale_fill_manual(values = cbp2[-c(1)]) +\n  scale_shape_manual(values = c(15:18, 25, 20, 21)) +\n  ggtitle(\"POLS\") +\n  theme_classic() +\n  theme(legend.key = element_blank(), \n        legend.title = element_blank(),\n        text = element_text(size = 10),\n        legend.position = c(1,0), \n        legend.justification = c(\"right\", \"bottom\"),\n        legend.background = element_blank(),\n        legend.box.background = element_rect(colour = \"black\")) \np_pols\n```\n\n::: {.cell-output-display}\n![](2_seminar_files/figure-revealjs/unnamed-chunk-6-1.png){width=960}\n:::\n:::\n\n\n\n:::\n\nInterpretation: Je höher das Alter einer Person, desto höher ihre Lebenszufriedenheit.\n\n## Regressionsmodelle: BE\n\nBE (Between Estimator): vergleicht verschiedene Personen und ignoriert die innerpersonelle Varianz. Modell verwendet nur die personenspezifischen Mittelwerte.\n\n$$\n\\bar{y_{i}} = \\alpha + \\beta_{BE} \\bar{x_{i}} + \\bar{\\upsilon_{i}},\n$$\n\n::: panel-tabset\n## Output\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">m lz</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.49</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.79&nbsp;&ndash;&nbsp;9.19</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.013</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">m alter</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.03&nbsp;&ndash;&nbsp;0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.208</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">7</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.295 / 0.154</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n\n## Code (by hand)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$m_lz <- ave(df$lz, df$id, FUN = mean)\ndf$m_alter <- ave(df$alter, df$id, FUN = mean)\n\nm_be <- lm(m_lz ~ m_alter, data = df %>% filter(count_within_group ==1))\ntab_model(m_be)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">m lz</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.49</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.79&nbsp;&ndash;&nbsp;9.19</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.013</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">m alter</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.03&nbsp;&ndash;&nbsp;0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.208</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">7</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.295 / 0.154</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n\n## Code with package plm\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(plm)\nm_be2 <- plm(lz ~ alter, data = df,\n           index = c(\"id\", \"syear\"),\n           effect = \"individual\", model = \"between\")\ntab_model(m_be2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">lz</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.49</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.79&nbsp;&ndash;&nbsp;9.19</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.013</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">alter</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.03&nbsp;&ndash;&nbsp;0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.208</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">7</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.295 / 0.154</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n:::\n\n## BE, graphisch\n\n::: panel-tabset\n## Output\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](2_seminar_files/figure-revealjs/unnamed-chunk-10-1.png){width=960}\n:::\n:::\n\n\n\n\n## Code\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf2 <- df\ndf2$lz <- df2$m_lz\ndf2$alter <- df2$m_alter\ndf2 <- df2[which(df2$syear == 2019), ]\n\n# Save the residual values\nm_be <- lm(m_lz ~ m_alter, data = df2)\ndf2$predicted <- predict(m_be)\ndf2$residuals <- residuals(m_be)\n\np_be <- ggplot(df, aes(alter, lz)) +\n  geom_point(aes(x = alter, y = lz, shape = id_name), \n              size = 2, stroke = 1, colour = alpha(\"black\", .3), fill = alpha(\"black\", .3)) +\n  geom_point(aes(x = m_alter, y = m_lz, shape = id_name, colour = id_name,\n                 fill = id_name), \n             size = 2, stroke = 1) +\n  geom_smooth(data = df2, \n              method = 'lm', formula = y ~ x, se = FALSE,\n              color  = \"cyan\") +\n  geom_segment(data = df2, aes(xend = alter, yend = predicted), \n               alpha = .3, color = \"deeppink\") +\n  annotate(\"text\", x = 30, y = 9.9,\n           label = paste0(\"beta[Between] ==\", round(m_be$coefficients[2], 3)), \n           parse = TRUE) +\n  scale_colour_manual(values = cbp2[-c(1)]) + \n  scale_fill_manual(values = cbp2[-c(1)]) + \n  scale_shape_manual(values = c(15:18, 25, 20, 21)) +\n  ggtitle(\"BE\") +\n  theme_classic() +\n  theme(legend.key = element_blank(), \n        legend.title = element_blank(),\n        text = element_text(size = 14),\n        legend.position = c(1,0), \n        legend.justification = c(\"right\", \"bottom\"),\n        legend.background = element_blank(),\n        legend.box.background = element_rect(colour = \"black\"))\n\np_be  \n```\n\n::: {.cell-output-display}\n![](2_seminar_files/figure-revealjs/unnamed-chunk-11-1.png){width=960}\n:::\n:::\n\n\n\n:::\n\n## Regressionsmodelle: Within Schätzer {.smaller}\n\n$$\ny_{it} - \\bar{y}_{i}= \\alpha_i-\\alpha_i + \\beta_1(x_{it}- \\bar{x}_i) +  \\beta_2(z_{i}- \\bar{z}_i) + \\epsilon_{it}-\\bar{\\epsilon}_{i} + u_{i}-\\bar{u}_{i},\n$$\n\n$$\ny_{it} - \\bar{y}_{i}=  \\beta_1(x_{it}- \\bar{x}_i) +   \\epsilon_{it}-\\bar{\\epsilon}_{i},\n$$\n\n![](images/clipboard-4222393806.png)\n\n## Regressionsmodelle: Within Schätzer {.scrollable}\n\n$$\ny_{it} - \\bar{y}_{i}= \\alpha_i-\\alpha_i + \\beta_1(x_{it}- \\bar{x}_i) +  \\beta_2(z_{i}- \\bar{z}_i) + \\epsilon_{it}-\\bar{\\epsilon}_{i} + u_{i}-\\bar{u}_{i},\n$$\n\n$$\ny_{it} - \\bar{y}_{i}=  \\beta_1(x_{it}- \\bar{x}_i) +   \\epsilon_{it}-\\bar{\\epsilon}_{i},\n$$\n\n$$\ny_{it} = \\alpha_i + \\beta_{WI} x_{it} + \\epsilon_{it},\n$$\n\nWithin-Schätzer: vergleicht **nur** verschiedene Zeitpunkte innerhalb derselben Person\n\nVorgehen: Für jede Person wird ein Dummy hinzugefügt\n\n→ Kontrolle auf zeitkonstante unbeobachtete Heterogenität\n\n## Within Schätzer, Anwendung {.scrollable}\n\n::: panel-tabset\n## Output\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">lz</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.42</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;15.90&nbsp;&ndash;&nbsp;11.07</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.716</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">alter</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.17</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.06&nbsp;&ndash;&nbsp;0.40</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.146</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">id name [17]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.72</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.68&nbsp;&ndash;&nbsp;4.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.152</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">id name [28]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.14</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;5.81&nbsp;&ndash;&nbsp;1.54</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.243</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">id name [29]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.52</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.88&nbsp;&ndash;&nbsp;3.92</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.204</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">id name [38]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.49</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.99&nbsp;&ndash;&nbsp;0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.050</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">id name [4]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.72</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;3.48&nbsp;&ndash;&nbsp;12.93</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.248</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">id name [8]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.35</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.30&nbsp;&ndash;&nbsp;3.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.105</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">34</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.632 / 0.532</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n\nInterpretation: Zunehmendes Alter einer Person geht mit einer zunehmenden Zufriedenheit derselben Person einher. \\## Code (by hand)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_fe <- lm(lz ~ alter + id_name, data = df)\ntab_model(m_fe)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">lz</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.42</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;15.90&nbsp;&ndash;&nbsp;11.07</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.716</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">alter</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.17</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.06&nbsp;&ndash;&nbsp;0.40</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.146</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">id name [17]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.72</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.68&nbsp;&ndash;&nbsp;4.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.152</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">id name [28]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.14</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;5.81&nbsp;&ndash;&nbsp;1.54</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.243</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">id name [29]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.52</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.88&nbsp;&ndash;&nbsp;3.92</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.204</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">id name [38]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.49</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.99&nbsp;&ndash;&nbsp;0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.050</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">id name [4]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.72</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;3.48&nbsp;&ndash;&nbsp;12.93</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.248</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">id name [8]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.35</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.30&nbsp;&ndash;&nbsp;3.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.105</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">34</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.632 / 0.532</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n\n## Code with package plm\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_fe2 <- plm(lz ~ alter, data = df,\n           index = c(\"id\", \"syear\"),\n           effect = \"individual\", model = \"within\")\ntab_model(m_fe2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">lz</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">alter</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.17</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.06&nbsp;&ndash;&nbsp;0.40</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.146</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">34</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.080 / -0.168</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n:::\n\n## Within, graphisch\n\n::: panel-tabset\n## Output\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](2_seminar_files/figure-revealjs/unnamed-chunk-15-1.png){width=960}\n:::\n:::\n\n\n\n\n## Code\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Lineares regressionsmodell für jede Person i\n# und Residuen speichern\nfor(i in unique(df$id)){\n  oo <- which(df$id == i)\n  lmt <- lm(lz ~ alter, data = df[oo, ])\n  df$predicted[oo] <- predict(lmt)\n  df$residuals[oo] <- residuals(lmt)\n}\n\n\ng_wi <- ggplot(df, aes(alter, lz)) +\n  geom_point( aes(x = alter, y = lz, shape = id_name, colour = id_name, fill  = id_name), \n              size = 2, stroke = 1) +\n  geom_smooth(method = 'lm', formula = y ~ x, se = FALSE, show.legend = FALSE,\n              mapping = aes(group = id_name),\n              color  = \"blue\", linetype = \"dotted\") +\n  geom_segment(data = df, aes(xend = alter, yend = predicted), \n               alpha = .3, color = \"deeppink\") +\n  annotate(\"text\", x = 30, y = 9.9, \n           label = paste0(\"beta[Within] ==\", round(m_fe$coefficients[2], 3)), \n           parse = TRUE) +\n  scale_fill_manual(values = cbp2[-c(1)]) +\n  scale_colour_manual(values = cbp2[-c(1)]) + \n  scale_shape_manual(values = c(15:18, 25, 20, 21)) +\n  ggtitle(\"WI (Fixed Effects)\") +\n  theme_classic() +\n  theme(legend.key = element_blank(), \n        legend.title = element_blank(),\n        text = element_text(size = 14),\n        legend.position = c(1,0), \n        legend.justification = c(\"right\", \"bottom\"),\n        legend.background = element_blank(),\n        legend.box.background = element_rect(colour = \"black\"))\n\ng_wi\n```\n\n::: {.cell-output-display}\n![](2_seminar_files/figure-revealjs/unnamed-chunk-16-1.png){width=960}\n:::\n:::\n\n\n\n:::\n\n## Regressionsmodelle: RE\n\n**Random effects** Schätzer:\n\n-   wird häugig in Mehrebenenanalysen genutzt\n-   Vorteile gegenüber FE:\n    -   effizienter (kleinere Standardfehler)\n    -   Effekte von zeitkonstanten Variablen können geschätzt werden\n-   Aber: Annahme, dass es keine (zeitkonstante und zeitveränderliche) unbeobachtete Heterogenität gibt\n\n## Regressionsmodelle: RE\n\nRE als quasi-demeaned Schätzer (gewichteter Durchschnitt des Between- und Within-Schätzers) $$\ny_{it} - \\lambda\\bar{y}_{i}=  (1-\\lambda)\\alpha_i+\\beta_1(x_{it}- \\lambda\\bar{x}_i) +   \\epsilon_{it}-\\lambda\\bar{\\epsilon}_{i},\n$$ mit $$\n\\hat{\\lambda} = 1 - \\sqrt{\\frac{\\sigma^2_\\epsilon}{\\sigma^2_\\epsilon + T\\sigma^2_\\alpha}}\n$$\\\n$\\lambda = 0$: POLS\n\n$\\lambda = 1$: FE\n\n$\\sigma^2$ = Varianz\n\n$T$ = Anzahl an Zeitpunkten\n\n## RE Schätzer, Anwendung {.scrollable}\n\n::: panel-tabset\n## Output\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">lz</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.14</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.31&nbsp;&ndash;&nbsp;7.97</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">alter</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.01&nbsp;&ndash;&nbsp;0.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.087</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">34</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.070 / 0.041</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n\n## Code\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_re <- plm(lz ~ alter, data = df,\n           index = c(\"id\", \"syear\"),\n           effect = \"individual\", model = \"random\")\ntab_model(m_re)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">lz</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.14</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.31&nbsp;&ndash;&nbsp;7.97</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">alter</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.01&nbsp;&ndash;&nbsp;0.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.087</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">34</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.070 / 0.041</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n:::\n\n## Hausman Test\n\nTestet ein „immer“ konsistentes Modell (FE-Modell) gegen ein „manchmal“ konsistentes aber dann effizientes Modell (RE-Modell) (Brüderl, S. 976)\n\nIdee: Man berechnet die standardisierte Differenz der Parameterschätzer. Ist die groß, so weicht das RE-Modell stark vom FE-Modell ab und es sollte das FE-Modell verwendet werden.\n\n$$\nH = (\\hat{\\beta}_{RE} -\\hat{\\beta}_{FE})'[\\hat{V}(\\hat{\\beta}_{RE}) -\\hat{V}(\\hat{\\beta}_{FE})]^{-1}\\hat{\\beta}_{RE} -\\hat{\\beta}_{FE}),\n$$ $\\hat{V}(.)$: geschätzte Varianz-Kovarianzmatrix der Schätzer\n\n## Hausman Test, Anwendung\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tHausman Test\n\ndata:  lz ~ alter\nchisq = 1.2944, df = 1, p-value = 0.2552\nalternative hypothesis: one model is inconsistent\n```\n\n\n:::\n:::\n\n\n\n\n::: notes\nHausmantest = nicht signifikant Nullhypothese wird nicht abgelehnt RE Schätzer ist nicht verzerrt durch unbeobachtete Heterogenität\n:::\n\n## Vergleich RE versus FE {.smaller}\n\n|   | RE Modell | FE Modell |\n|------------------|---------------------------|---------------------------|\n| Unbeobachtete Heterogenität | Verzerrt, wenn personenspezifische unbeobachtete Heterogenität vorliegt (Selbstselektion) | Nicht verzerrt durch personenspezifische unbeobachteter Heterogenität (within-Vergleich) |\n| Zeitkonstante Variablen | Können mitgeschätzt werden (sind aber verzerrt, wenn unbeobachtete Heterogenität vorliegt) | Können nicht mitgeschätzt werden, werden aber implizit mitkontrolliert = konsistent |\n| Standardfehler | Tendenziell kleiner (da mehr Variation in den Daten genutzt wird) | Tendenziell größer (da nur within-Varianz genutzt wird) |\n| Zeitveränderliche Variablen |  | Ohne Veränderung (before-after comparison) kann keine within-Varianz geschätzt werden |\n\n## Vergleich {.smaller}\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"2\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">POLS</th>\n<th colspan=\"2\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">BE</th>\n<th colspan=\"2\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">FE</th>\n<th colspan=\"2\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">RE</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7\">p</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8\">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9\">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.395</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.490</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.013</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8\">5.144</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9\"><strong>0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">alter</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.040</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.007</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.037</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.208</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.169</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\">0.146</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8\">0.044</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9\">0.087</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"2\">34</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"2\">7</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"2\">34</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"2\">34</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"2\">0.207 / 0.182</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"2\">0.295 / 0.154</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"2\">0.080 / -0.168</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"2\">0.070 / 0.041</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n\n\n# Zurück zur Kausalanalyse\n\n## Drittvariablenkontrolle\n\nIdee von Regressionsverfahren: Kontrolle von Drittvariablenkontrolle, um unbeobachtete Heterogenität zu verringern.\n\nAber: gezielte Auswahl von Variablen notwendig!\n\n## DAGs\n\nDirect acyclic graph (DAG): eine grafische Darstellung der kausalen Annahmen in dem Datengenerierungsprozess\n\n![Elwert & Winship (2014)](images/clipboard-198247011.png)\n\n## 3 Probleme bei der Drittvariablenkontrolle\n\n-   Overcontrol bias\n\n-   Confounding bias\n\n-   Endogenous selection bias\n\n## Overcontrol bias\n\n![Elwert & Winship (2014)](images/clipboard-4178067939.png)\n\n## Confounding\n\n![Elwert & Winship (2014)](images/clipboard-822005744.png)\n\n## Endogenous selection bias\n\n![Elwert & Winship (2014)](images/clipboard-2354627611.png)\n\n::: notes\nFrage: Führt Talent zu hübschen Aussehen? (Kausal: nein!) A: Talent B: Beauty C: Hollywood success\n\n-   beauty and talent are unassociated\n-   beauty führt zu Erfolg\n-   talent führt zu Erfolg\n\nKontrolle auf Erfolg (zb looking at the relationship between beauty and talent only among successful Hollywood actors): conditioning on the collider (Erfolg) has created a spurious association between beauty and talent among the successful. This spurious association is endogenous selection bias.\n:::\n\n## Ende\n\n-   Dieser Foliensatz profitierte in großen Teilen von ehemaligen Veranstaltungen von Isabel Habicht sowie von\n\n-   https://ruettenauer.github.io/Panel-Data-Analysis/\n\n-   Weitere Literatur:\n\n    -   Josef Brüderl and Volker Ludwig: [Folien](https://www.ls3.soziologie.uni-muenchen.de/studium-lehre/archiv/teaching-marterials/panel-analysis_april-2019.pdf)\n",
    "supporting": [
      "2_seminar_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}